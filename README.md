# **From Cyst to Tapeworm: Transcriptome Analysis of *Taenia solium* *In Vitro* Activation**  

This repository contains the scripts used for validating and analyzing the *Taenia solium* transcriptome. The workflow serves as a starting point for data exploration and hypothesis generation.  

The pipeline includes:  
1. **QC, trimming, read mapping and counts matrix generation** for validating read quality, mapping to *T. solium* reference genome and generating a count matrix.
2. **Clustering analysis** for validating experimental groups.  
3. **Functional annotation** using an annotation package to allow **Over-Representation Analysis (ORA)** of functional categories.  

---

## **Data**

### **Data Folder** (`Data/`)
Contains the counts matrix and the DESeq2 object used in the analysis:  
- **`counts.RData`** ‚Üí Matrix of raw counts per gene, used as input for **DESeq2**.  
- **`dds.RData`** ‚Üí The **dds object** after **normalization and transformation** in DESeq2.
- **`table_reads_summary.xlsx`** ‚Üí A summary table of read mapping and qc.

---

## **Software and Dependencies**  

This analysis was conducted using:  

### **R and Packages**  
- **R version 4.4.2**  
  - `tidyverse`: Data manipulation (`dplyr`) and visualization (`ggplot2`).  
  - `DESeq2`: Differential gene expression (DGE) analysis.  
  - `tidyplots`: Custom visualization.  
  - `eulerr`: Visualization of DEGs across experimental conditions.  
  - `annotationForge` and `AnnotationDbi`: Creation of a custom annotation package from OmicsBox data.  
  - `clusterProfiler`: ORA and Gene Set Enrichment Analysis (GSEA).
  - `Rsubread`: Mapping to reference genome.
  - `GenomicFeatures`: Generating a TxDb object and counts matrix. 

### **Additional Software**  
- **FastQC 0.12.0 and multiQC**
- **RStudio 2024.12.0 Build 467**  
- **OmicsBox 3.3.2**  

---

## **Experimental Samples and Conditions**  

Each sample is labeled based on the biological stage and treatment condition:  

- **AT** = *TA+* (With Taurocholic Acid)  
- **SAT** = *TA-* (Without Taurocholic Acid)  

| Label in code | Sample name | Description |
|--------------|------------|-------------|
| **NC** | NC | Non-cultured cysts |
| **PRE_SAT** | PRE TA- | *Non-evaginated* cysts cultured for 6h in RPMI *-TA* |
| **PRE_AT** | PRE TA+ | *Non-evaginated* cysts cultured for 6h in RPMI *+TA* |
| **EV_SAT** | EV TA- | *Recently evaginated* individuals (12-24h) in RPMI *-TA* |
| **EV_AT** | EV TA+ | *Recently evaginated* individuals (12-24h) in RPMI *+TA* |
| **POST_SAT** | POST TA- | *Evaginated* individuals cultured for 120h in RPMI *-TA* |
| **POST_AT** | POST TA+ | *Evaginated* individuals cultured for 120h in RPMI *+TA* |

---

## **Usage: Scripts Overview**  

### **1. Quality Control, Trimming, Read Mapping and Count Matrix**  
- **`QC_trimming.sh`**  
  - Performs **Quality Control** and **Trimming** of adapters. Must be ran on terminal.  
- **`read_mapping_count_matrix.R`**  
  - Maps reads to *Taenia solium* reference genome (https://parasite.wormbase.org/Taenia_solium_prjna170813/Info/Index/).
  - Generates the count matrix for DGE analysis.  

### **2. Technical Validation and Data Exploration**  
- **`DGE_PCA_hierarchical_clustering.R`**  
  - Performs **DGE analysis**, **PCA**, and **hierarchical clustering** to validate sample groups.  
- **`euler_plots.R`**  
  - Generates **Euler diagrams** to compare DEGs across experimental conditions (*e.g.,* -TA vs. +TA).
- **`MA_plot.R`**
  - Generates **MA plots** to visualize log-fold change vs mean expression between two groups.    

### **2. Further Analysis:**  
- **`blast2go_annotation.R`**  
  - Converts OmicsBox output into a functional annotation **R package** with **GO terms**.  

---

## **GO Annotations and Annotation Package**  

### **GO Annotations Folder** (`GO_annotations/`)  
Contains the functional annotation data exported from OmicsBox:  
- **`GO_annotations.txt`** ‚Üí Used in `blast2go_annotation.R` to create an annotation object.  
- **`OmicsBoxProj_tsolium-annotation_details.pdf`** ‚Üí OmicsBox annotation project details.  
- **`Tsolium_annotation_full-export.xlsx`** ‚Üí Full annotation results from OmicsBox.  

### **Annotation Package Folder** (`annotation_package/`)  
Includes files generated by `annotationForge`, which can be used to install the custom annotation package.  

To install:  
```r
install.packages("org.Tsolium.eg.db", repos = NULL, type = "source")
```
 
---

## **Pipeline Contributions**:
Segundo Del √Åguila performed QC, trimming, read mapping and generation of a counts matrix.
Segundo Del √Åguila, Renzo Gutierrez and David Casta√±eda performed DGE analysis, technical validation of samples and initial data exploration.
David Casta√±eda performed gene annotation.

---

## **Contact:**

For questions or issues, feel free to contact:

- üìß David Casta√±eda ‚Äì david.castaneda.c@upch.pe
- üìß Segundo Del √Åguila ‚Äì segundo.del.aguila.s@upch.pe
- üìß Renzo Gutierrez ‚Äì renzo.gutierrez@upch.pe
